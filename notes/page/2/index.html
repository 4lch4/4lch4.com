<!doctype html><html><head><title>Notes</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><link rel=stylesheet href=/css/bootstrap.min.css><link rel=stylesheet href=/css/layouts/main.css><link rel=stylesheet href=/css/navigators/navbar.css><link rel=stylesheet href=/css/plyr.css><link rel=stylesheet href=/css/flag-icon.min.css><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Muli:wght@300;400;500;600"><link rel=stylesheet href=/fontawesome/css/all.min.css><link rel=stylesheet href=/css/colortheme/colortheme.css><link rel=icon type=image/png href=/images/site/favicon_hu21a6a806c4b006128b6b8c10c7e088ee_15784_42x0_resize_box_3.png><meta property="og:title" content="Notes"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="https://4lch4.com/notes/"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/atom-one-dark.min.css><link rel=stylesheet href=/css/layouts/notes.css><link rel=stylesheet href=/css/navigators/sidebar.css></head><body data-spy=scroll data-target=#TableOfContents data-offset=80><div class="container-fluid bg-dimmed wrapper"><nav class="navbar navbar-expand-xl top-navbar final-navbar shadow"><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button onclick=toggleSidebar()>
<span class=navbar-toggler-icon></span></button>
<a class=navbar-brand href=/><img src=/images/site/avatar_hubc0edc237a662a9609c6ecf2557ff250_452118_42x0_resize_box_3.png alt=Logo>
4lch4's Homepage</a>
<button class="navbar-toggler navbar-light" id=toc-toggler type=button onclick=toggleTOC()>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse lang-selector" id=top-nav-items><ul class="navbar-nav ml-auto"><li class="nav-item dropdown"><div id=theme-initialization style=display:none default-theme=system></div><a class="nav-link dropdown-toggle" href=# id=themeSelector role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false><img id=navbar-theme-icon-svg src=/icons/moon-svgrepo-com.svg width=20></a><div class="dropdown-menu dropdown-menu-icons-only" aria-labelledby=themeSelector><a class="dropdown-item nav-link" href=# onclick=enableLightTheme()><img class=menu-icon-center src=/icons/sun-svgrepo-com.svg width=20></a>
<a class="dropdown-item nav-link" href=# onclick=enableDarkTheme()><img class=menu-icon-center src=/icons/moon-svgrepo-com.svg width=20></a>
<a class="dropdown-item nav-link" href=# onclick=useSystemTheme()><img class=menu-icon-center src=/icons/computer-svgrepo-com.svg width=20></a></div></li></ul></div></div><img src=/images/site/avatar_hubc0edc237a662a9609c6ecf2557ff250_452118_42x0_resize_box_3.png class=d-none id=main-logo alt=Logo>
<img src=/images/site/avatar_hubc0edc237a662a9609c6ecf2557ff250_452118_42x0_resize_box_3.png class=d-none id=inverted-logo alt="Inverted Logo"></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><form class=mx-auto method=get action=/search><input type=text name=keyword placeholder=Search data-search id=search-box></form><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/notes data-filter=all>Notes</a></li><div class=subtree><li><i class="fas fa-plus-circle"></i><a href=/notes/development/>Development</a><ul><li><a href=/notes/development/4lch4.com/ title=4lch4.com>4lch4.com</a></li><li><i class="fas fa-plus-circle"></i><a href=/notes/development/badges/>Badges</a><ul><li><a href=/notes/development/badges/standard/ title=Standard>Standard</a></li><li><a href=/notes/development/badges/chat/ title=Chat>Chat</a></li><li><a href=/notes/development/badges/code-style/ title="Code Style">Code Style</a></li><li><a href=/notes/development/badges/countly/ title=Countly>Countly</a></li><li><a href=/notes/development/badges/dependencies/ title=Dependencies>Dependencies</a></li><li><a href=/notes/development/badges/licensing/ title=Licensing>Licensing</a></li><li><a href=/notes/development/badges/other/ title=Other>Other</a></li><li><a href=/notes/development/badges/size/ title=Size>Size</a></li><li><a href=/notes/development/badges/versioning/ title=Versioning>Versioning</a></li><li><a href=/notes/development/badges/for-fun/ title="For Fun">For Fun</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/notes/development/node/>NodeJS</a><ul><li><i class="fas fa-plus-circle"></i><a href=/notes/development/node/snippets/>NodeJS Snippets</a><ul><li><a href=/notes/development/node/snippets/color-console/ title="Colorize Console Output">Colorize Console Output</a></li><li><a href=/notes/development/node/snippets/colors.ts/ title=Colors.ts>Colors.ts</a></li><li><a href=/notes/development/node/snippets/create-dir-if-not-exists/ title="Create Directory if not Found">Create Directory if not Found</a></li><li><a href=/notes/development/node/snippets/get-all-files/ title="Get All Files">Get All Files</a></li><li><a href=/notes/development/node/snippets/uuid-generation/ title="UUID Generation">UUID Generation</a></li></ul></li></ul></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/notes/infrastructure/>Infrastructure</a><ul><li><a href=/notes/infrastructure/secrets-management/ title="Secret(s) Management">Secret(s) Management</a></li><li><i class="fas fa-plus-circle"></i><a href=/notes/infrastructure/secrets/>Secrets</a><ul><li><a href=/notes/infrastructure/secrets/doppler/ title="Doppler Secrets Manager">Doppler Secrets Manager</a></li></ul></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/notes/misc/>Misc. Notes</a><ul><li><a href=/notes/misc/razergreen/ title="Razer Green Color">Razer Green Color</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href>notes-infrastructure-doppler-secrets</a><ul><li><a href=/notes/infrastructure/secrets/installation/ title="Doppler Installation">Doppler Installation</a></li><li><a href=/notes/infrastructure/secrets/running-commands/ title="Running Commands">Running Commands</a></li><li><a href=/notes/infrastructure/secrets/programatic-access/ title="Programatic Access">Programatic Access</a></li><li><a href=/notes/infrastructure/secrets/vscode-node-support/ title="VSCode Node Support">VSCode Node Support</a></li><li><a href=/notes/infrastructure/secrets/integrations/ title="Doppler Integrations">Doppler Integrations</a></li><li><a href=/notes/infrastructure/secrets/api/ title="Doppler API">Doppler API</a></li></ul></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class="content container-fluid" id=content><div class="container-fluid note-card-holder" id=note-card-holder><div class=note-card><div class=item><h5 class=note-title><span>Programatic Access</span></h5><div class=card><div class=card-body><div class="alert alert-info"><strong>Accessing the secrets injected by <a href=https://www.doppler.com target=_blank>Doppler</a> within a programming language:</strong></div><h2 id=node>Node</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>secret</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>process</span>.<span style=color:#a6e22e>env</span>[<span style=color:#e6db74>&#39;SECRET_NAME&#39;</span>]
</span></span></code></pre></div><br><h2 id=python>Python</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>secret <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>getenv(<span style=color:#e6db74>&#34;SECRET_NAME&#34;</span>)
</span></span></code></pre></div><br><h2 id=go>Go</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>secret</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>os</span>.<span style=color:#a6e22e>Getenv</span>(<span style=color:#e6db74>&#34;SECRET_NAME&#34;</span>)
</span></span></code></pre></div><br><h2 id=java>Java</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>String secret <span style=color:#f92672>=</span> System<span style=color:#f92672>.</span><span style=color:#a6e22e>getenv</span><span style=color:#f92672>().</span><span style=color:#a6e22e>get</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;SECRET_NAME&#34;</span><span style=color:#f92672>)</span>
</span></span></code></pre></div><br><h2 id=rust>Rust</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span>secret <span style=color:#f92672>=</span> env::var(<span style=color:#e6db74>&#34;SECRET_NAME&#34;</span>)
</span></span></code></pre></div><br><h2 id=kotlin>Kotlin</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>var secret<span style=color:#f92672>:</span> String <span style=color:#f92672>=</span> System<span style=color:#f92672>.</span><span style=color:#a6e22e>getenv</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;SECRET_NAME&#34;</span><span style=color:#f92672>)</span>
</span></span></code></pre></div></div></div></div></div><div class=note-card><div class=item><h5 class=note-title><span>Chat</span></h5><div class=card><div class=card-body><ul><li>Discord<ul><li><a href=https://discord.gg/W72x4Ks><img src="https://img.shields.io/discord/325504841541746688?color=7289DA&style=flat-square" alt=Discord></a></li><li><code>[![Discord](https://img.shields.io/discord/325504841541746688?color=7289DA&style=flat-square)](https://discord.gg/W72x4Ks)</code></li></ul></li></ul></div></div></div></div><div class=note-card><div class=item><h5 class=note-title><span>VSCode Node Support</span></h5><div class=card><div class=card-body><div class="alert alert-info"><strong>This note is a trimmed copy of <a href=https://docs.doppler.com/docs/vscode-nodejs target=_blank>a guide</a> provided by <a href=https://www.doppler.com target=_blank>Doppler</a> that will &ldquo;show you how to integrate the Doppler CLI into your Node.js application development and debugging workflow inside Visual Studio Code.&rdquo;:</strong></div><h2 id=prerequisites>Prerequisites</h2><p>Before beginning, ensure the following prerequisites have been met:</p><ul><li><a href=https://docs.doppler.com/docs/enclave-installation target=_blank>Doppler CLI</a> installed locally and authenticated (<code>doppler login</code>).</li><li>Created a <a href=https://docs.doppler.com/docs/enclave-project-setup target=_blank>Doppler Project</a> for your application</li></ul><h2 id=launch-configuration>Launch Configuration</h2><p>Update your existing launch configuration by creating or setting <code>runtimeExecutable</code> to <code>doppler</code> and <code>runtimeArgs</code> to include the command for running your application.</p><p>A typical launch configuration object will look like the following:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;version&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;0.2.0&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;configurations&#34;</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;name&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;node: server&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;type&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;node&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;request&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;launch&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;runtimeExecutable&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;doppler&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;runtimeArgs&#34;</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#34;run&#34;</span>, <span style=color:#e6db74>&#34;--&#34;</span>, <span style=color:#e6db74>&#34;npm&#34;</span>,<span style=color:#e6db74>&#34;start&#34;</span>]
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  ]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></div></div></div><div class=note-card><div class=item><h5 class=note-title><span>Doppler Integrations</span></h5><div class=card><div class=card-body><div class="alert alert-info"><strong>&ldquo;Doppler connects to a <a href=https://docs.doppler.com/docs/integrations target=_blank>growing list of providers</a> to keep your secrets in sync wherever you develop and deploy.&rdquo; This note provides information on the integrations that are relevant to my infrastructure/use-case(s).</strong></div><ul><li>DigitalOcean<ul><li><a href=https://docs.doppler.com/docs/digitalocean>https://docs.doppler.com/docs/digitalocean</a></li></ul></li><li>Docker<ul><li><a href=https://docs.doppler.com/docs/installation-docker>https://docs.doppler.com/docs/installation-docker</a></li></ul></li><li>Docker Compose<ul><li><a href=https://docs.doppler.com/docs/docker-compose>https://docs.doppler.com/docs/docker-compose</a></li></ul></li><li>Kubernetes<ul><li><a href=https://docs.doppler.com/docs/kubernetes>https://docs.doppler.com/docs/kubernetes</a></li></ul></li><li>Terraform<ul><li><a href=https://docs.doppler.com/docs/terraform>https://docs.doppler.com/docs/terraform</a></li></ul></li><li>Vercel<ul><li><a href=https://docs.doppler.com/docs/vercel>https://docs.doppler.com/docs/vercel</a></li></ul></li></ul></div></div></div></div><div class=note-card><div class=item><h5 class=note-title><span>Code Style</span></h5><div class=card><div class=card-body><ul><li>Prettier<ul><li><a href=https://github.com/prettier/prettier><img src="https://img.shields.io/badge/code_style-prettier-ff69b4.svg?style=flat-square" alt="code style: prettier"></a></li><li><code>[![code style: prettier](https://img.shields.io/badge/code_style-prettier-ff69b4.svg?style=flat-square)](https://github.com/prettier/prettier)</code></li></ul></li></ul></div></div></div></div><div class=note-card><div class=item><h5 class=note-title><span>Countly</span></h5><div class=card><div class=card-body><p>For sites that utilize <a href=https://count.ly>Countly</a> for analytics.</p><ul><li><a href=https://count.ly/f/badge><img src=https://count.ly/badges/dark.svg alt=Dark-Theme></a><ul><li><code>[![Dark-Theme](https://count.ly/badges/dark.svg)](https://count.ly/f/badge)</code></li></ul></li><li><a href=https://count.ly/f/badge><img src=https://count.ly/badges/light.svg alt=Light-Theme></a><ul><li><code>[![Light-Theme](https://count.ly/badges/light.svg)](https://count.ly/f/badge)</code></li></ul></li></ul></div></div></div></div><div class=note-card><div class=item><h5 class=note-title><span>Dependencies</span></h5><div class=card><div class=card-body><ul><li>David<ul><li><img src=https://img.shields.io/david/4lch4/Digital-Garden alt=David></li><li><code>![David](https://img.shields.io/david/4lch4/Digital-Garden)</code></li></ul></li></ul></div></div></div></div><div class=note-card><div class=item><h5 class=note-title><span>Doppler API</span></h5><div class=card><div class=card-body><div class="alert alert-info"><strong><p>This note provides information on how to fetch Doppler secrets from within your application.</p><p>Doppler provides the <a href=https://docs.doppler.com/reference#download target=_blank>Secrets Download API</a> however, if you&rsquo;re using NodeJS then you can make use of their <a href=https://www.npmjs.com/package/gitops-secrets target=_blank>gitops-secrets library</a> to do this a bit easier.</p></strong></div><div class="alert alert-warning"><strong><em>NOTE: Doppler has plans to publish an official SDK for Node, Go, and PHP, but when it will be available has not been shared, so this is the only method for the time being.</em></strong></div><h2 id=preflight-check>Preflight Check</h2><p>The first step is to create a <a href=https://docs.doppler.com/docs/enclave-service-tokens target=_blank>Service Token</a> to provide read-only access to the project and config you wish to supply secrets for:</p><p><img src=https://assets.4lch4.cloud/projects/4lch4.com/notes/Copy-Service-Token.png alt=Copy-Service-Token></p><p>Then expose the Service Token value to your environment using the <code>DOPPLER_TOKEN</code> environment variable:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>export DOPPLER_TOKEN<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;dp.st.dev.xxxx&#39;</span>
</span></span></code></pre></div><br><h2 id=async>Async</h2><p>Create a <code>doppler-secrets.js</code> file and fetch secrets from the API using either the built-in <code>https</code> module or a third-party package such as <a href=https://www.npmjs.com/package/axios>axios</a>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>// doppler-secrets.js
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>https</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;https&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>module</span>.<span style=color:#a6e22e>exports</span>.<span style=color:#a6e22e>getSecrets</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>async</span> () =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> Promise(<span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>resolve</span>, <span style=color:#a6e22e>reject</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>https</span>
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>get</span>(
</span></span><span style=display:flex><span>        <span style=color:#e6db74>`https://</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>process</span>.<span style=color:#a6e22e>env</span>.<span style=color:#a6e22e>DOPPLER_TOKEN</span><span style=color:#e6db74>}</span><span style=color:#e6db74>@api.doppler.com/v3/configs/config/secrets/download?format=json`</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>res</span> =&gt; {
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>secrets</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>on</span>(<span style=color:#e6db74>&#39;data&#39;</span>, <span style=color:#a6e22e>data</span> =&gt; (<span style=color:#a6e22e>secrets</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>data</span>))
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>on</span>(<span style=color:#e6db74>&#39;end&#39;</span>, () =&gt; <span style=color:#a6e22e>resolve</span>(<span style=color:#a6e22e>JSON</span>.<span style=color:#a6e22e>parse</span>(<span style=color:#a6e22e>secrets</span>)))
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      )
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>on</span>(<span style=color:#e6db74>&#39;error&#39;</span>, <span style=color:#a6e22e>e</span> =&gt; <span style=color:#a6e22e>reject</span>(<span style=color:#a6e22e>e</span>))
</span></span><span style=display:flex><span>  })
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>// doppler-secrets.js
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>axios</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;axios&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>module</span>.<span style=color:#a6e22e>exports</span>.<span style=color:#a6e22e>getSecrets</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>async</span> () =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>response</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>axios</span>.<span style=color:#a6e22e>get</span>(
</span></span><span style=display:flex><span>    <span style=color:#e6db74>`https://</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>process</span>.<span style=color:#a6e22e>env</span>.<span style=color:#a6e22e>DOPPLER_TOKEN</span><span style=color:#e6db74>}</span><span style=color:#e6db74>@api.doppler.com/v3/configs/config/secrets/download?format=json`</span>
</span></span><span style=display:flex><span>  )
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>data</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Then use an async require to fetch the secrets in your application:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>// app.js
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>doppler</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;./doppler-secrets&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>;(<span style=color:#66d9ef>async</span> () =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>secrets</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>doppler</span>.<span style=color:#a6e22e>getSecrets</span>()
</span></span><span style=display:flex><span>})()
</span></span></code></pre></div><h2 id=sync>Sync</h2><p>Using async code to fetch secrets may have the undesirable side effect of making previously synchronous code now async.</p><p>A workaround for fetching secrets asynchronously is to provide the additional option for executing <code>doppler-secrets.js</code> as a script and parsing the JSON output from <code>stdout</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>// doppler-secrets.js
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>https</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;https&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>module</span>.<span style=color:#a6e22e>exports</span>.<span style=color:#a6e22e>getSecrets</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>async</span> () =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> Promise(<span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>resolve</span>, <span style=color:#a6e22e>reject</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>https</span>
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>get</span>(
</span></span><span style=display:flex><span>        <span style=color:#e6db74>`https://</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>process</span>.<span style=color:#a6e22e>env</span>.<span style=color:#a6e22e>DOPPLER_TOKEN</span><span style=color:#e6db74>}</span><span style=color:#e6db74>@api.doppler.com/v3/configs/config/secrets/download?format=json`</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>res</span> =&gt; {
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>secrets</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>on</span>(<span style=color:#e6db74>&#39;data&#39;</span>, <span style=color:#a6e22e>data</span> =&gt; (<span style=color:#a6e22e>secrets</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>data</span>))
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>on</span>(<span style=color:#e6db74>&#39;end&#39;</span>, () =&gt; <span style=color:#a6e22e>resolve</span>(<span style=color:#a6e22e>JSON</span>.<span style=color:#a6e22e>parse</span>(<span style=color:#a6e22e>secrets</span>)))
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      )
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>on</span>(<span style=color:#e6db74>&#39;error&#39;</span>, <span style=color:#a6e22e>e</span> =&gt; <span style=color:#a6e22e>reject</span>(<span style=color:#a6e22e>e</span>))
</span></span><span style=display:flex><span>  })
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// If executed as a script
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>require</span>.<span style=color:#a6e22e>main</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>module</span>) {
</span></span><span style=display:flex><span>  ;(<span style=color:#66d9ef>async</span> () =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>secrets</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>getSecrets</span>()
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>process</span>.<span style=color:#a6e22e>stdout</span>.<span style=color:#a6e22e>write</span>(<span style=color:#a6e22e>JSON</span>.<span style=color:#a6e22e>stringify</span>(<span style=color:#a6e22e>secrets</span>))
</span></span><span style=display:flex><span>  })()
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>// doppler-secrets.js
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>axios</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;axios&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>module</span>.<span style=color:#a6e22e>exports</span>.<span style=color:#a6e22e>getSecrets</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>async</span> () =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>response</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>axios</span>.<span style=color:#a6e22e>get</span>(
</span></span><span style=display:flex><span>    <span style=color:#e6db74>`https://</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>process</span>.<span style=color:#a6e22e>env</span>.<span style=color:#a6e22e>DOPPLER_TOKEN</span><span style=color:#e6db74>}</span><span style=color:#e6db74>@api.doppler.com/v3/configs/config/secrets/download?format=json`</span>
</span></span><span style=display:flex><span>  )
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>data</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// If executed as a script
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>require</span>.<span style=color:#a6e22e>main</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>module</span>) {
</span></span><span style=display:flex><span>  ;(<span style=color:#66d9ef>async</span> () =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>secrets</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>getSecrets</span>()
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>process</span>.<span style=color:#a6e22e>stdout</span>.<span style=color:#a6e22e>write</span>(<span style=color:#a6e22e>JSON</span>.<span style=color:#a6e22e>stringify</span>(<span style=color:#a6e22e>secrets</span>))
</span></span><span style=display:flex><span>  })()
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Then execute <code>doppler-secrets.js</code> synchronously:</p><p>JavaScript</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>// app.js
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>secrets</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>JSON</span>.<span style=color:#a6e22e>parse</span>(<span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;child_process&#39;</span>).<span style=color:#a6e22e>execSync</span>(<span style=color:#e6db74>&#39;node doppler-secrets.js&#39;</span>))
</span></span></code></pre></div></div></div></div></div><div class=note-card><div class=item><h5 class=note-title><span>For Fun</span></h5><div class=card><div class=card-body><ul><li><a href=https://forthebadge.com><img src=https://forthebadge.com/images/badges/60-percent-of-the-time-works-every-time.svg alt=ForTheBadge></a><ul><li><code>[![ForTheBadge](https://forthebadge.com/images/badges/60-percent-of-the-time-works-every-time.svg)](https://forthebadge.com)</code></li></ul></li><li><a href=https://forthebadge.com><img src=https://forthebadge.com/images/badges/ages-18.svg alt=ForTheBadge></a><ul><li><code>[![ForTheBadge](https://forthebadge.com/images/badges/ages-18.svg)](https://forthebadge.com)</code></li></ul></li><li><a href=https://forthebadge.com><img src=https://forthebadge.com/images/badges/approved-by-veridian-dynamics.svg alt=ForTheBadge></a><ul><li><code>[![ForTheBadge](https://forthebadge.com/images/badges/approved-by-veridian-dynamics.svg)](https://forthebadge.com)</code></li></ul></li><li><a href=https://forthebadge.com><img src=https://forthebadge.com/images/badges/as-seen-on-tv.svg alt=ForTheBadge></a><ul><li><code>[![ForTheBadge](https://forthebadge.com/images/badges/as-seen-on-tv.svg)](https://forthebadge.com)</code></li></ul></li><li><a href=https://forthebadge.com><img src=https://forthebadge.com/images/badges/built-by-developers.svg alt=ForTheBadge></a><ul><li><code>[![ForTheBadge](https://forthebadge.com/images/badges/built-by-developers.svg)](https://forthebadge.com)</code></li></ul></li><li><a href=https://forthebadge.com><img src=https://forthebadge.com/images/badges/built-by-hipsters.svg alt=ForTheBadge></a><ul><li><code>[![ForTheBadge](https://forthebadge.com/images/badges/built-by-hipsters.svg)](https://forthebadge.com)</code></li></ul></li><li><a href=https://forthebadge.com><img src=https://forthebadge.com/images/badges/built-by-neckbeards.svg alt=ForTheBadge></a><ul><li><code>[![ForTheBadge](https://forthebadge.com/images/badges/built-by-neckbeards.svg)](https://forthebadge.com)</code></li></ul></li><li><a href=https://forthebadge.com><img src=https://forthebadge.com/images/badges/built-for-android.svg alt=ForTheBadge></a><ul><li><code>[![ForTheBadge](https://forthebadge.com/images/badges/built-for-android.svg)](https://forthebadge.com)</code></li></ul></li><li><a href=https://forthebadge.com><img src=https://forthebadge.com/images/badges/built-with-grammas-recipe.svg alt=ForTheBadge></a><ul><li><code>[![ForTheBadge](https://forthebadge.com/images/badges/built-with-grammas-recipe.svg)](https://forthebadge.com)</code></li></ul></li><li><a href=https://forthebadge.com><img src=https://forthebadge.com/images/badges/check-it-out.svg alt=ForTheBadge></a><ul><li><code>[![ForTheBadge](https://forthebadge.com/images/badges/check-it-out.svg)](https://forthebadge.com)</code></li></ul></li><li><a href=https://forthebadge.com><img src=https://forthebadge.com/images/badges/contains-17-coffee-cups.svg alt=ForTheBadge></a><ul><li><code>[![ForTheBadge](https://forthebadge.com/images/badges/contains-17-coffee-cups.svg)](https://forthebadge.com)</code></li></ul></li><li><a href=https://forthebadge.com><img src=https://forthebadge.com/images/badges/designed-in-ms-paint.svg alt=ForTheBadge></a><ul><li><code>[![ForTheBadge](https://forthebadge.com/images/badges/designed-in-ms-paint.svg)](https://forthebadge.com)</code></li></ul></li><li><a href=https://forthebadge.com><img src=https://forthebadge.com/images/badges/fuck-it-ship-it.svg alt=ForTheBadge></a><ul><li><code>[![ForTheBadge](https://forthebadge.com/images/badges/fuck-it-ship-it.svg)](https://forthebadge.com)</code></li></ul></li><li><a href=https://forthebadge.com><img src=https://forthebadge.com/images/badges/no-ragrets.svg alt=ForTheBadge></a><ul><li><code>[![ForTheBadge](https://forthebadge.com/images/badges/no-ragrets.svg)](https://forthebadge.com)</code></li></ul></li><li><a href=https://forthebadge.com><img src=https://forthebadge.com/images/badges/not-a-bug-a-feature.svg alt=ForTheBadge></a><ul><li><code>[![ForTheBadge](https://forthebadge.com/images/badges/not-a-bug-a-feature.svg)](https://forthebadge.com)</code></li></ul></li><li><a href=https://forthebadge.com><img src=https://forthebadge.com/images/badges/powered-by-black-magic.svg alt=ForTheBadge></a><ul><li><code>[![ForTheBadge](https://forthebadge.com/images/badges/powered-by-black-magic.svg)](https://forthebadge.com)</code></li></ul></li><li><a href=https://forthebadge.com><img src=https://forthebadge.com/images/badges/uses-badges.svg alt=ForTheBadge></a><ul><li><code>[![ForTheBadge](https://forthebadge.com/images/badges/uses-badges.svg)](https://forthebadge.com)</code></li></ul></li><li><a href=https://forthebadge.com><img src=https://forthebadge.com/images/badges/works-on-my-machine.svg alt=ForTheBadge></a><ul><li><code>[![ForTheBadge](https://forthebadge.com/images/badges/works-on-my-machine.svg)](https://forthebadge.com)</code></li></ul></li></ul></div></div></div></div><div class=note-card><div class=item><h5 class=note-title><span>Licensing</span></h5><div class=card><div class=card-body><ul><li>NPM License<ul><li><img src=https://img.shields.io/npm/l/@4lch4/pblib alt=NPM></li><li><code>![NPM](https://img.shields.io/npm/l/@4lch4/pblib)</code></li></ul></li></ul></div></div></div></div></div><div class=paginator><ul class="pagination pagination-default"><li class=page-item><a href=/notes/ aria-label=First class=page-link role=button><span aria-hidden=true>&#171;&#171;</span></a></li><li class=page-item><a href=/notes/ aria-label=Previous class=page-link role=button><span aria-hidden=true>&#171;</span></a></li><li class=page-item><a href=/notes/ aria-label="Page 1" class=page-link role=button>1</a></li><li class="page-item active"><a aria-current=page aria-label="Page 2" class=page-link role=button>2</a></li><li class=page-item><a href=/notes/page/3/ aria-label="Page 3" class=page-link role=button>3</a></li><li class=page-item><a href=/notes/page/4/ aria-label="Page 4" class=page-link role=button>4</a></li><li class=page-item><a href=/notes/page/3/ aria-label=Next class=page-link role=button><span aria-hidden=true>&#187;</span></a></li><li class=page-item><a href=/notes/page/4/ aria-label=Last class=page-link role=button><span aria-hidden=true>&#187;&#187;</span></a></li></ul></div></div></section></div><footer id=footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-left"><div class="col-md-4 col-sm-12"><h5>Navigation</h5><ul><li class=nav-item><a class=smooth-scroll href=https://4lch4.com#about>About</a></li><li class=nav-item><a class=smooth-scroll href=https://4lch4.com#skills>Skills</a></li><li class=nav-item><a class=smooth-scroll href=https://4lch4.com#experiences>Experiences</a></li><li class=nav-item><a class=smooth-scroll href=https://4lch4.com#education>Education</a></li><li class=nav-item><a class=smooth-scroll href=https://4lch4.com#projects>Projects</a></li><li class=nav-item><a class=smooth-scroll href=https://4lch4.com#accomplishments>Achievements</a></li></ul></div><div class="col-md-4 col-sm-12"><h5>Contact me:</h5><ul><li><a href=mailto:hey@4lch4.email target=_blank rel=noopener><span><i class="fas fa-envelope"></i></span> <span>hey@4lch4.email</span></a></li><li><a href=https://github.com/4lch4 target=_blank rel=noopener><span><i class="fab fa-github"></i></span> <span>4lch4</span></a></li><li><a href=https://www.linkedin.com/in/devin-leaman-49622429 target=_blank rel=noopener><span><i class="fab fa-linkedin"></i></span> <span>Devin Leaman</span></a></li></ul></div></div></div><hr><div class=container><p id=disclaimer><strong>Liability Notice:</strong> This website and the theme it uses are published under the MIT license. So, you can use it for
non-commercial, commercial, or private uses. You can modify or distribute the theme without
requiring any permission from the theme author. However, the theme author does not provide any
warranty or takes any liability for any issue with the theme. For further information, I recommend
you refer to the following URL: <a href=https://opensource.org/licenses/MIT>https://opensource.org/licenses/MIT</a></p></div><hr><div class=container><div class="row text-left"><div class=col-md-4><a id=theme href=https://git.4lch4.io/4lch4/Toha-Theme target=_blank rel=noopener><img src=/images/theme-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_32x0_resize_box_3.png alt="Toha Theme Logo">
Toha</a></div><div class="col-md-4 text-center">Copyright © 2022 4lch4</div><div class="col-md-4 text-right"><a id=hugo href=https://gohugo.io/ target=_blank rel=noopener>Powered by
<img src=/images/hugo-logo.svg alt="Hugo Logo" height=18></a></div></div></div></footer><script type=text/javascript src=/js/jquery-3.4.1.min.js></script>
<script type=text/javascript src=/js/popper.min.js></script>
<script type=text/javascript src=/js/bootstrap.min.js></script>
<script type=text/javascript src=/js/navbar.js></script>
<script type=text/javascript src=/js/plyr.js></script>
<script type=text/javascript src=/js/main.js></script>
<script type=text/javascript src=/js/darkreader.js></script>
<script type=text/javascript src=/js/darkmode-darkreader.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js></script>
<script src=/js/imagesloaded.pkgd.min.js></script>
<script src=/js/note.js></script>
<script>hljs.initHighlightingOnLoad()</script></body></html>